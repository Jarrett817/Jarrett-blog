<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    
    <title>微前端 | Vite &amp; Vue powered static site generator</title>
    <meta name="description" content="前端学习笔记">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/Jarrett-blog/assets/style.BxYy6MEi.css" as="style">
    <link rel="preload stylesheet" href="/Jarrett-blog/vp-icons.css" as="style">
    
    <script type="module" src="/Jarrett-blog/assets/app.hQUXQupM.js"></script>
    <link rel="preload" href="/Jarrett-blog/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Jarrett-blog/assets/chunks/theme.DXZAdxYV.js">
    <link rel="modulepreload" href="/Jarrett-blog/assets/chunks/framework.C1rSk1pR.js">
    <link rel="modulepreload" href="/Jarrett-blog/assets/front-end_micro-front_index.md.CvufYgRx.lean.js">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link rel="icon" href="/Jarrett-blogfavicon.jpg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="n-config-provider" data-v-e044f95b><!----><div class="Layout" data-v-e044f95b data-v-ffb09705><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d2b01218></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-d2b01218> Skip to content </a><!--]--><!----><header class="VPNav" data-v-ffb09705 data-v-d5086a5b><div class="VPNavBar has-sidebar top" data-v-d5086a5b data-v-b1dc54d2><div class="wrapper" data-v-b1dc54d2><div class="container" data-v-b1dc54d2><div class="title" data-v-b1dc54d2><div class="VPNavBarTitle has-sidebar" data-v-b1dc54d2 data-v-896105e3><a class="title" href="/Jarrett-blog/" data-v-896105e3><!--[--><!--]--><!----><span data-v-896105e3>🏠 JarrettBlog</span><!--[--><!--]--></a></div></div><div class="content" data-v-b1dc54d2><div class="content-body" data-v-b1dc54d2><!--[--><!--]--><div class="VPNavBarSearch search" data-v-b1dc54d2><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-b1dc54d2 data-v-3f5a4db7><span id="main-nav-aria-label" class="visually-hidden" data-v-3f5a4db7> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/Jarrett-blog/front-end/html/" tabindex="0" data-v-3f5a4db7 data-v-e9668232><!--[--><span data-v-e9668232>📘 前端基础</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/Jarrett-blog/computer-basic/design-pattern/" tabindex="0" data-v-3f5a4db7 data-v-e9668232><!--[--><span data-v-e9668232>📚 计算机基础</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/Jarrett-blog/plan/micro-fe-communication/" tabindex="0" data-v-3f5a4db7 data-v-e9668232><!--[--><span data-v-e9668232>🏹 方案</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/Jarrett-blog/practice/leetcode.html" tabindex="0" data-v-3f5a4db7 data-v-e9668232><!--[--><span data-v-e9668232>✍ 练习题</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/Jarrett-blog/web3/" tabindex="0" data-v-3f5a4db7 data-v-e9668232><!--[--><span data-v-e9668232>📘 WEB3</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/Jarrett-blog/resume/index.html" tabindex="0" data-v-3f5a4db7 data-v-e9668232><!--[--><span data-v-e9668232>🔖 简历</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-b1dc54d2 data-v-d84b2752><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d84b2752 data-v-56ef3316 data-v-80588559><span class="check" data-v-80588559><span class="icon" data-v-80588559><!--[--><span class="vpi-sun sun" data-v-56ef3316></span><span class="vpi-moon moon" data-v-56ef3316></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-b1dc54d2 data-v-29e6104c data-v-4603dc2a><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Jarrett817/Jarrett-blog" aria-label="github" target="_blank" rel="noopener" data-v-4603dc2a data-v-1f6bfc78><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://juejin.cn/user/3940246036687774" aria-label target="_blank" rel="noopener" data-v-4603dc2a data-v-1f6bfc78><svg t="1658975064450" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14624" width="500" height="500"><path d="M465.189 161.792c-22.967 18.14-44.325 35.109-47.397 37.742l-5.851 4.68 10.971 8.632c5.998 4.827 11.85 9.508 13.02 10.532 1.17 1.024 17.993 14.336 37.156 29.696l34.962 27.795 5.267-3.95c2.925-2.194 23.259-18.432 45.348-35.986 21.943-17.555 41.253-32.768 42.716-33.646 1.609-1.024 2.779-2.194 2.779-2.78 0-0.438-9.655-8.63-21.504-17.846-11.995-9.363-22.674-17.847-23.845-18.871-15.945-13.02-49.737-39.059-50.76-39.059-0.586 0.147-19.896 14.922-42.862 33.061z m233.325 180.37C507.465 493.275 508.928 492.105 505.417 489.911c-3.072-1.902-11.556-8.485-64.073-50.03-9.07-7.168-18.578-14.775-21.358-16.823-2.78-2.194-8.777-6.875-13.312-10.532-4.68-3.657-10.679-8.339-13.312-10.533-13.165-10.24-71.095-56.027-102.107-80.457-5.852-4.681-11.41-8.485-12.142-8.485-0.731 0-10.971 7.754-22.674 17.116-11.703 9.508-22.674 18.286-24.284 19.456-1.755 1.17-5.12 3.95-7.46 6.144-2.34 2.34-4.828 4.096-5.413 4.096-3.072 0-0.731 3.072 6.437 8.777 4.096 3.218 8.777 6.875 10.094 8.046 1.316 1.024 10.24 8.045 19.748 15.506s23.26 18.286 30.428 23.99c19.31 15.215 31.89 25.308 127.853 101.084 47.836 37.742 88.796 69.779 90.844 71.095 3.657 2.487 3.95 2.487 7.46-0.292a1041.42 1041.42 0 0 0 16.092-12.727c6.875-5.413 14.775-11.703 17.554-13.897 30.135-23.699 80.018-63.05 81.774-64.512 1.17-1.024 12.434-9.802 24.868-19.603s37.888-29.696 56.32-44.324c18.579-14.629 46.227-36.425 61.733-48.567 15.506-12.142 27.794-22.528 27.502-23.26-0.878-1.17-57.637-47.104-59.978-48.274-0.731-0.439-18.578 12.727-39.497 29.257z" fill="#006CFF" p-id="14625"></path><path d="M57.93 489.326c-15.215 12.288-28.527 23.405-29.697 24.576-2.34 2.194-5.412-0.44 80.018 66.852 33.207 26.185 32.622 25.747 57.637 45.495 10.386 8.192 36.279 28.672 57.783 45.495 38.18 30.135 44.91 35.401 52.663 41.545 2.048 1.756 22.967 18.14 46.372 36.572 23.26 18.432 74.167 58.514 112.933 89.088 38.912 30.573 71.095 55.734 71.826 56.027 0.732 0.293 7.46-4.389 14.921-10.386 21.797-16.97 90.259-70.949 101.523-79.872 5.705-4.535 12.873-10.24 15.945-12.58 3.072-2.488 6.436-5.12 7.314-5.852 0.878-0.878 11.85-9.509 24.283-19.31 20.773-16.091 59.1-46.226 64.366-50.615 1.17-1.024 5.12-4.096 8.777-6.875 3.657-2.78 7.9-6.29 9.509-7.607 1.609-1.317 14.775-11.703 29.257-23.113 29.11-22.82 42.277-33.207 88.503-69.632 17.262-13.605 32.475-25.454 33.646-26.478 2.486-2.048 31.451-24.869 44.617-35.255 4.827-3.657 9.07-7.168 9.508-7.607 0.44-0.585 5.998-4.827 12.435-9.8 6.436-4.828 13.165-10.24 15.067-11.85l3.365-2.926-9.948-7.753c-5.412-4.388-10.24-8.192-10.679-8.63-1.17-1.317-22.381-18.433-30.135-24.284-3.95-3.072-7.314-5.998-7.606-6.73-1.317-3.071-6.73 0.147-29.258 17.994-13.458 10.532-25.746 20.187-27.355 21.504-1.61 1.463-10.533 8.338-19.749 15.652-9.216 7.168-17.115 13.459-17.554 13.898-0.439 0.438-6.583 5.412-13.897 10.971-7.168 5.559-15.214 11.703-17.7 13.75-4.974 4.097-5.413 4.39-20.334 16.239-5.56 4.388-11.264 8.777-12.435 9.8-1.17 1.025-20.333 16.092-42.422 33.354-22.09 17.408-41.546 32.768-43.155 34.084-1.609 1.463-14.482 11.557-28.525 22.528s-40.814 32.037-59.539 46.812c-18.578 14.775-42.276 33.353-52.516 41.399s-23.26 18.285-28.965 22.82l-10.386 8.339-4.389-3.072c-2.34-1.756-4.68-3.511-5.12-3.95-0.439-0.439-4.973-4.096-10.24-8.046-11.849-9.216-14.482-11.264-16.676-13.166-0.878-0.877-4.243-3.51-7.46-5.851-3.22-2.487-6.145-4.681-6.584-5.12-0.439-0.439-6.875-5.705-14.482-11.703-7.607-5.851-14.921-11.556-16.091-12.58-1.317-1.17-17.116-13.605-35.255-27.795-17.993-14.19-35.109-27.648-38.035-29.842-5.705-4.681-33.499-26.624-125.074-98.743-34.523-27.209-72.704-57.344-84.846-66.852-49.737-39.498-55.15-43.594-56.905-43.447-0.877 0-14.043 10.24-29.257 22.528z" fill="#006CFF" p-id="14626"></path></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-b1dc54d2 data-v-a7f6646a data-v-17857302><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-17857302><span class="vpi-more-horizontal icon" data-v-17857302></span></button><div class="menu" data-v-17857302><div class="VPMenu" data-v-17857302 data-v-d932083f><!----><!--[--><!--[--><!----><div class="group" data-v-a7f6646a><div class="item appearance" data-v-a7f6646a><p class="label" data-v-a7f6646a>Appearance</p><div class="appearance-action" data-v-a7f6646a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-a7f6646a data-v-56ef3316 data-v-80588559><span class="check" data-v-80588559><span class="icon" data-v-80588559><!--[--><span class="vpi-sun sun" data-v-56ef3316></span><span class="vpi-moon moon" data-v-56ef3316></span><!--]--></span></span></button></div></div></div><div class="group" data-v-a7f6646a><div class="item social-links" data-v-a7f6646a><div class="VPSocialLinks social-links-list" data-v-a7f6646a data-v-4603dc2a><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Jarrett817/Jarrett-blog" aria-label="github" target="_blank" rel="noopener" data-v-4603dc2a data-v-1f6bfc78><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://juejin.cn/user/3940246036687774" aria-label target="_blank" rel="noopener" data-v-4603dc2a data-v-1f6bfc78><svg t="1658975064450" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="14624" width="500" height="500"><path d="M465.189 161.792c-22.967 18.14-44.325 35.109-47.397 37.742l-5.851 4.68 10.971 8.632c5.998 4.827 11.85 9.508 13.02 10.532 1.17 1.024 17.993 14.336 37.156 29.696l34.962 27.795 5.267-3.95c2.925-2.194 23.259-18.432 45.348-35.986 21.943-17.555 41.253-32.768 42.716-33.646 1.609-1.024 2.779-2.194 2.779-2.78 0-0.438-9.655-8.63-21.504-17.846-11.995-9.363-22.674-17.847-23.845-18.871-15.945-13.02-49.737-39.059-50.76-39.059-0.586 0.147-19.896 14.922-42.862 33.061z m233.325 180.37C507.465 493.275 508.928 492.105 505.417 489.911c-3.072-1.902-11.556-8.485-64.073-50.03-9.07-7.168-18.578-14.775-21.358-16.823-2.78-2.194-8.777-6.875-13.312-10.532-4.68-3.657-10.679-8.339-13.312-10.533-13.165-10.24-71.095-56.027-102.107-80.457-5.852-4.681-11.41-8.485-12.142-8.485-0.731 0-10.971 7.754-22.674 17.116-11.703 9.508-22.674 18.286-24.284 19.456-1.755 1.17-5.12 3.95-7.46 6.144-2.34 2.34-4.828 4.096-5.413 4.096-3.072 0-0.731 3.072 6.437 8.777 4.096 3.218 8.777 6.875 10.094 8.046 1.316 1.024 10.24 8.045 19.748 15.506s23.26 18.286 30.428 23.99c19.31 15.215 31.89 25.308 127.853 101.084 47.836 37.742 88.796 69.779 90.844 71.095 3.657 2.487 3.95 2.487 7.46-0.292a1041.42 1041.42 0 0 0 16.092-12.727c6.875-5.413 14.775-11.703 17.554-13.897 30.135-23.699 80.018-63.05 81.774-64.512 1.17-1.024 12.434-9.802 24.868-19.603s37.888-29.696 56.32-44.324c18.579-14.629 46.227-36.425 61.733-48.567 15.506-12.142 27.794-22.528 27.502-23.26-0.878-1.17-57.637-47.104-59.978-48.274-0.731-0.439-18.578 12.727-39.497 29.257z" fill="#006CFF" p-id="14625"></path><path d="M57.93 489.326c-15.215 12.288-28.527 23.405-29.697 24.576-2.34 2.194-5.412-0.44 80.018 66.852 33.207 26.185 32.622 25.747 57.637 45.495 10.386 8.192 36.279 28.672 57.783 45.495 38.18 30.135 44.91 35.401 52.663 41.545 2.048 1.756 22.967 18.14 46.372 36.572 23.26 18.432 74.167 58.514 112.933 89.088 38.912 30.573 71.095 55.734 71.826 56.027 0.732 0.293 7.46-4.389 14.921-10.386 21.797-16.97 90.259-70.949 101.523-79.872 5.705-4.535 12.873-10.24 15.945-12.58 3.072-2.488 6.436-5.12 7.314-5.852 0.878-0.878 11.85-9.509 24.283-19.31 20.773-16.091 59.1-46.226 64.366-50.615 1.17-1.024 5.12-4.096 8.777-6.875 3.657-2.78 7.9-6.29 9.509-7.607 1.609-1.317 14.775-11.703 29.257-23.113 29.11-22.82 42.277-33.207 88.503-69.632 17.262-13.605 32.475-25.454 33.646-26.478 2.486-2.048 31.451-24.869 44.617-35.255 4.827-3.657 9.07-7.168 9.508-7.607 0.44-0.585 5.998-4.827 12.435-9.8 6.436-4.828 13.165-10.24 15.067-11.85l3.365-2.926-9.948-7.753c-5.412-4.388-10.24-8.192-10.679-8.63-1.17-1.317-22.381-18.433-30.135-24.284-3.95-3.072-7.314-5.998-7.606-6.73-1.317-3.071-6.73 0.147-29.258 17.994-13.458 10.532-25.746 20.187-27.355 21.504-1.61 1.463-10.533 8.338-19.749 15.652-9.216 7.168-17.115 13.459-17.554 13.898-0.439 0.438-6.583 5.412-13.897 10.971-7.168 5.559-15.214 11.703-17.7 13.75-4.974 4.097-5.413 4.39-20.334 16.239-5.56 4.388-11.264 8.777-12.435 9.8-1.17 1.025-20.333 16.092-42.422 33.354-22.09 17.408-41.546 32.768-43.155 34.084-1.609 1.463-14.482 11.557-28.525 22.528s-40.814 32.037-59.539 46.812c-18.578 14.775-42.276 33.353-52.516 41.399s-23.26 18.285-28.965 22.82l-10.386 8.339-4.389-3.072c-2.34-1.756-4.68-3.511-5.12-3.95-0.439-0.439-4.973-4.096-10.24-8.046-11.849-9.216-14.482-11.264-16.676-13.166-0.878-0.877-4.243-3.51-7.46-5.851-3.22-2.487-6.145-4.681-6.584-5.12-0.439-0.439-6.875-5.705-14.482-11.703-7.607-5.851-14.921-11.556-16.091-12.58-1.317-1.17-17.116-13.605-35.255-27.795-17.993-14.19-35.109-27.648-38.035-29.842-5.705-4.681-33.499-26.624-125.074-98.743-34.523-27.209-72.704-57.344-84.846-66.852-49.737-39.498-55.15-43.594-56.905-43.447-0.877 0-14.043 10.24-29.257 22.528z" fill="#006CFF" p-id="14626"></path></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-b1dc54d2 data-v-04046837><span class="container" data-v-04046837><span class="top" data-v-04046837></span><span class="middle" data-v-04046837></span><span class="bottom" data-v-04046837></span></span></button></div></div></div></div><div class="divider" data-v-b1dc54d2><div class="divider-line" data-v-b1dc54d2></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-ffb09705 data-v-a5ffc52e><div class="container" data-v-a5ffc52e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a5ffc52e><span class="vpi-align-left menu-icon" data-v-a5ffc52e></span><span class="menu-text" data-v-a5ffc52e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a5ffc52e data-v-98eee035><button data-v-98eee035>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-ffb09705 data-v-ae7e1657><div class="curtain" data-v-ae7e1657></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ae7e1657><span class="visually-hidden" id="sidebar-aria-label" data-v-ae7e1657> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-6412ece5><section class="VPSidebarItem level-0 has-active" data-v-6412ece5 data-v-ef850759><div class="item" role="button" tabindex="0" data-v-ef850759><div class="indicator" data-v-ef850759></div><h2 class="text" data-v-ef850759>前端基础</h2><!----></div><div class="items" data-v-ef850759><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/html/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>HTML</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/css/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>CSS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/js/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>JS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/ts/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>TS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/browser/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>浏览器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/vue/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>vue</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/vue3/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>vue3</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/nodejs/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>nodejs</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/git/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>git</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/canvas/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>canvas</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/micro-front/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>微前端</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/front-end/miniprogram/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>小程序</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-6412ece5><section class="VPSidebarItem level-0" data-v-6412ece5 data-v-ef850759><div class="item" role="button" tabindex="0" data-v-ef850759><div class="indicator" data-v-ef850759></div><h2 class="text" data-v-ef850759>计算机基础</h2><!----></div><div class="items" data-v-ef850759><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/computer-basic/design-pattern/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>设计模式</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/computer-basic/internet/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>计算机网络</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/computer-basic/arithmetic/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>数据结构与算法</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-6412ece5><section class="VPSidebarItem level-0" data-v-6412ece5 data-v-ef850759><div class="item" role="button" tabindex="0" data-v-ef850759><div class="indicator" data-v-ef850759></div><h2 class="text" data-v-ef850759>方案</h2><!----></div><div class="items" data-v-ef850759><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/plan/navigation/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>多级跳转</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/plan/micro-fe-communication/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>微前端下的主子通信</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/plan/api-test/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>接口测试平台</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/plan/how-to-make-ts-useful/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>10分钟速通TS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/plan/front-end-infrastructure/" data-v-ef850759><!--[--><p class="text" data-v-ef850759>前端基建（一）</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-6412ece5><section class="VPSidebarItem level-0" data-v-6412ece5 data-v-ef850759><div class="item" role="button" tabindex="0" data-v-ef850759><div class="indicator" data-v-ef850759></div><h2 class="text" data-v-ef850759>WEB3</h2><!----></div><div class="items" data-v-ef850759><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/web3/index.html" data-v-ef850759><!--[--><p class="text" data-v-ef850759>新手入门</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-6412ece5><section class="VPSidebarItem level-0" data-v-6412ece5 data-v-ef850759><div class="item" role="button" tabindex="0" data-v-ef850759><div class="indicator" data-v-ef850759></div><h2 class="text" data-v-ef850759>练习题</h2><!----></div><div class="items" data-v-ef850759><!--[--><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/practice/leetcode.html" data-v-ef850759><!--[--><p class="text" data-v-ef850759>算法题</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-ef850759 data-v-ef850759><div class="item" data-v-ef850759><div class="indicator" data-v-ef850759></div><a class="VPLink link link" href="/Jarrett-blog/practice/promise.html" data-v-ef850759><!--[--><p class="text" data-v-ef850759>Promise</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-ffb09705 data-v-30f0ecb7><div class="VPDoc has-sidebar has-aside" data-v-30f0ecb7 data-v-3f19d6b0><!--[--><!--]--><div class="container" data-v-3f19d6b0><div class="aside" data-v-3f19d6b0><div class="aside-curtain" data-v-3f19d6b0></div><div class="aside-container" data-v-3f19d6b0><div class="aside-content" data-v-3f19d6b0><div class="VPDocAside" data-v-3f19d6b0 data-v-e53cbd78><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-e53cbd78 data-v-c3513957><div class="content" data-v-c3513957><div class="outline-marker" data-v-c3513957></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-c3513957>On this page</div><ul class="VPDocOutlineItem root" data-v-c3513957 data-v-d1d61fd6><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-e53cbd78></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--[--><!--[--><!--[--><button class="n-button n-button--info-type n-button--large-type" tabindex="0" type="button" style="--n-bezier:cubic-bezier(.4, 0, .2, 1);--n-bezier-ease-out:cubic-bezier(0, 0, .2, 1);--n-ripple-duration:.6s;--n-opacity-disabled:0.5;--n-wave-opacity:0.6;font-weight:400;--n-color:#0000;--n-color-hover:rgba(46, 51, 56, .09);--n-color-pressed:rgba(46, 51, 56, .13);--n-color-focus:rgba(46, 51, 56, .09);--n-color-disabled:#0000;--n-ripple-color:#0000;--n-text-color:#2080f0;--n-text-color-hover:#2080f0;--n-text-color-pressed:#2080f0;--n-text-color-focus:#2080f0;--n-text-color-disabled:#2080f0;--n-border:1px solid #2080f0;--n-border-hover:1px solid #4098fc;--n-border-pressed:1px solid #1060c9;--n-border-focus:1px solid #4098fc;--n-border-disabled:1px solid #2080f0;--n-width:40px;--n-height:40px;--n-font-size:15px;--n-padding:initial;--n-icon-size:20px;--n-icon-margin:6px;--n-border-radius:40px;" data-v-e044f95b><!----><span class="n-button__icon" style="margin:0;"><div class="n-icon-slot" role="none"><i role="img" class="n-icon" style="--n-bezier:cubic-bezier(.4, 0, .2, 1);--n-color:;--n-opacity:;font-size:20px;" data-v-e044f95b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" data-v-e044f95b><path d="M20 2v2h6.586L18 12.582L19.414 14L28 5.414V12h2V2H20z" fill="currentColor"></path><path d="M14 19.416L12.592 18L4 26.586V20H2v10h10v-2H5.414L14 19.416z" fill="currentColor"></path></svg></i></div></span><!----><div aria-hidden="true" class="n-base-wave"></div><!----><!----></button><!--]--><!--]--><!--]--><!--]--></div></div></div></div><div class="content" data-v-3f19d6b0><div class="content-container" data-v-3f19d6b0><!--[--><!--]--><main class="main" data-v-3f19d6b0><div style="position:relative;" class="vp-doc _Jarrett-blog_front-end_micro-front_" data-v-3f19d6b0><div><h1 id="微前端" tabindex="-1">微前端 <a class="header-anchor" href="#微前端" aria-label="Permalink to &quot;微前端&quot;">​</a></h1><h2 id="什么是微前端" tabindex="-1">什么是微前端 <a class="header-anchor" href="#什么是微前端" aria-label="Permalink to &quot;什么是微前端&quot;">​</a></h2><p>微前端是一种多个团队通过独立发布功能的方式来共同构建现代化 web 应用的技术手段及方法策略。就是在一个 web 应用中可以独立的运行另一个 web 应用</p><h3 id="核心价值" tabindex="-1">核心价值 <a class="header-anchor" href="#核心价值" aria-label="Permalink to &quot;核心价值&quot;">​</a></h3><ul><li><p>技术栈无关 主框架不限制接入应用的技术栈，微应用具备完全自主权</p></li><li><p>独立开发、独立部署 微应用仓库独立，前后端可独立开发，部署完成后主框架自动完成同步更新</p></li><li><p>增量升级 在面对各种复杂场景时，我们通常很难对一个已经存在的系统做全量的技术栈升级或重构，而微前端是一种非常好的实施渐进式重构的手段和策略</p></li><li><p>独立运行时 每个微应用之间状态隔离，运行时状态不共享</p></li></ul><h3 id="为什么不直接用-iframe" tabindex="-1">为什么不直接用 iframe？ <a class="header-anchor" href="#为什么不直接用-iframe" aria-label="Permalink to &quot;为什么不直接用 iframe？&quot;">​</a></h3><p>如果不考虑体验问题，iframe 几乎是最完美的微前端解决方案。存在问题如下</p><ul><li>浏览器原生隔离，完美解决 js、css 隔离问题，但是应用上下文难以共享，包括内存变量、数据同步、内外通信、cookie 透传</li><li>路由状态丢失，浏览器刷新一下，iframe 的 url 状态就丢失了</li><li>慢。每次打开白屏时间太长，对于 SPA 应用来说无法接受</li><li>dom 结构不共享。弹框只能在 iframe 内部展示，无法覆盖全局</li></ul><h2 id="微前端编年史" tabindex="-1">微前端编年史 <a class="header-anchor" href="#微前端编年史" aria-label="Permalink to &quot;微前端编年史&quot;">​</a></h2><h3 id="_1-概念阶段" tabindex="-1">1. 概念阶段 <a class="header-anchor" href="#_1-概念阶段" aria-label="Permalink to &quot;1. 概念阶段&quot;">​</a></h3><p>微前端的概念是由 ThoughtWorks 在 2016 年提出的，它借鉴了微服务的架构理念，核心在于将一个庞大的前端应用拆分成多个独立灵活的小型应用，每个应用都可以独立开发、独立运行、独立部署，再将这些小型应用融合为一个完整的应用，或者将原本运行已久、没有关联的几个应用融合为一个应用。微前端既可以将多个项目融合为一，又可以减少项目之间的耦合，提升项目扩展性，相比一整块的前端仓库，微前端架构下的前端仓库倾向于更小更灵活。</p><p>主力工具：iframe</p><h3 id="_2-模块化加载" tabindex="-1">2. 模块化加载 <a class="header-anchor" href="#_2-模块化加载" aria-label="Permalink to &quot;2. 模块化加载&quot;">​</a></h3><p>随着前端模块化工具的发展，微前端解决方案开始引入模块化加载器，如 Webpack 和 SystemJS</p><ul><li>Webpack：通过使用 Webpack 的动态导入（Dynamic Imports）和插件，可以实现模块的按需加载。</li><li>SystemJS：是一种模块加载器，可以用于动态加载模块，尤其是在单页面应用（SPA）中</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki solarized-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#586E75;font-style:italic;">// 通过 Webpack 4 的 import() 实现动态加载</span></span>
<span class="line"></span>
<span class="line"><span style="color:#859900;">import</span><span style="color:#839496;">(</span><span style="color:#2AA198;">&#39;path/to/module&#39;</span><span style="color:#839496;">).</span><span style="color:#268BD2;">then</span><span style="color:#839496;">(module </span><span style="color:#93A1A1;font-weight:bold;">=&gt;</span><span style="color:#839496;"> {</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  // 使用模块</span></span>
<span class="line"><span style="color:#859900;">  module</span><span style="color:#839496;">.</span><span style="color:#268BD2;">someFunction</span><span style="color:#839496;">();</span></span>
<span class="line"><span style="color:#839496;">});</span></span></code></pre></div><p>优点：</p><ul><li>按需加载，提高了资源利用效率。</li><li>更少的性能开销，相较于 iframe。</li></ul><p>缺点：</p><ul><li>依然较为复杂的配置。</li><li>需要解决模块间依赖和共享的问题。</li></ul><h3 id="_3-微前端框架的出现" tabindex="-1">3. 微前端框架的出现 <a class="header-anchor" href="#_3-微前端框架的出现" aria-label="Permalink to &quot;3. 微前端框架的出现&quot;">​</a></h3><p>为了更好地解决微前端的复杂性和多样性需求，出现了一些专门的微前端框架和平台。</p><ul><li>Single-SPA：是一个 JavaScript 框架，可以帮助你在一个页面上组合多个微前端子应用，支持多种框架（如 React、Vue、Angular 等）。核心思想是将不同的微前端应用按照路由来分离，并在路由切换的时候激活相应的子应用。</li><li>qiankun：qiankun 是基于 Single-SPA 的进行封装和扩展的一个微前端解决方案，它提高了开发体验和框架兼容性。配置化的应用接入更简单，拓展提供了 css、js 沙箱及主子通讯方法，还提供了预加载的能力</li><li>wujie：使用 shadowDom 隔离 css，使用空的 iframe 隔离 js，通讯使用的是 proxy</li><li>micro-app：初期基于 webcomponent + qiankun js 沙箱的微前端方案，后基于 iframe 实现 js 沙箱</li></ul><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-VI6bZ" id="tab-f6jV2Gl" checked><label data-title="single-spa" for="tab-f6jV2Gl">single-spa</label><input type="radio" name="group-VI6bZ" id="tab-sRf_cCp"><label data-title="qiankun" for="tab-sRf_cCp">qiankun</label><input type="radio" name="group-VI6bZ" id="tab-tzc4ne4"><label data-title="模块联邦" for="tab-tzc4ne4">模块联邦</label></div><div class="blocks"><div class="language-js active"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki solarized-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#586E75;font-style:italic;">// single-spa</span></span>
<span class="line"><span style="color:#859900;">import</span><span style="color:#839496;"> { </span><span style="color:#268BD2;">registerApplication</span><span style="color:#839496;">, </span><span style="color:#268BD2;">start</span><span style="color:#839496;"> } </span><span style="color:#859900;">from</span><span style="color:#2AA198;"> &#39;single-spa&#39;</span><span style="color:#839496;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268BD2;">registerApplication</span><span style="color:#839496;">(</span></span>
<span class="line"><span style="color:#2AA198;">  &#39;app1&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">  () </span><span style="color:#93A1A1;font-weight:bold;">=&gt;</span><span style="color:#859900;"> import</span><span style="color:#839496;">(</span><span style="color:#2AA198;">&#39;path/to/app1&#39;</span><span style="color:#839496;">),</span></span>
<span class="line"><span style="color:#839496;">  location </span><span style="color:#93A1A1;font-weight:bold;">=&gt;</span><span style="color:#268BD2;"> location</span><span style="color:#839496;">.</span><span style="color:#268BD2;">pathname</span><span style="color:#839496;">.</span><span style="color:#268BD2;">startsWith</span><span style="color:#839496;">(</span><span style="color:#2AA198;">&#39;/app1&#39;</span><span style="color:#839496;">)</span></span>
<span class="line"><span style="color:#839496;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268BD2;">start</span><span style="color:#839496;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#859900;">export</span><span style="color:#93A1A1;font-weight:bold;"> const</span><span style="color:#268BD2;"> bootstrap</span><span style="color:#859900;"> =</span><span style="color:#93A1A1;font-weight:bold;"> async</span><span style="color:#93A1A1;font-weight:bold;"> function</span><span style="color:#839496;"> () {</span></span>
<span class="line"><span style="color:#268BD2;">  console</span><span style="color:#839496;">.</span><span style="color:#268BD2;">log</span><span style="color:#839496;">(</span><span style="color:#2AA198;">&#39;应用正在启动&#39;</span><span style="color:#839496;">);</span></span>
<span class="line"><span style="color:#839496;">};</span></span>
<span class="line"><span style="color:#859900;">export</span><span style="color:#93A1A1;font-weight:bold;"> const</span><span style="color:#268BD2;"> mount</span><span style="color:#859900;"> =</span><span style="color:#93A1A1;font-weight:bold;"> async</span><span style="color:#93A1A1;font-weight:bold;"> function</span><span style="color:#839496;"> () {};</span></span>
<span class="line"><span style="color:#859900;">export</span><span style="color:#93A1A1;font-weight:bold;"> const</span><span style="color:#268BD2;"> unmount</span><span style="color:#859900;"> =</span><span style="color:#93A1A1;font-weight:bold;"> async</span><span style="color:#93A1A1;font-weight:bold;"> function</span><span style="color:#839496;"> () {</span></span>
<span class="line"><span style="color:#268BD2;">  console</span><span style="color:#839496;">.</span><span style="color:#268BD2;">log</span><span style="color:#839496;">(</span><span style="color:#2AA198;">&#39;应用正在卸载&#39;</span><span style="color:#839496;">);</span></span>
<span class="line"><span style="color:#268BD2;">  document</span><span style="color:#839496;">.</span><span style="color:#268BD2;">body</span><span style="color:#839496;">.</span><span style="color:#268BD2;">removeChild</span><span style="color:#839496;">(</span><span style="color:#268BD2;">childContainer</span><span style="color:#839496;">);</span></span>
<span class="line"><span style="color:#839496;">};</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki solarized-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#586E75;font-style:italic;">// 主应用</span></span>
<span class="line"><span style="color:#859900;">import</span><span style="color:#839496;"> { </span><span style="color:#268BD2;">registerMicroApps</span><span style="color:#839496;">, </span><span style="color:#268BD2;">start</span><span style="color:#839496;"> } </span><span style="color:#859900;">from</span><span style="color:#2AA198;"> &#39;qiankun&#39;</span><span style="color:#839496;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268BD2;">registerMicroApps</span><span style="color:#839496;">([</span></span>
<span class="line"><span style="color:#839496;">  {</span></span>
<span class="line"><span style="color:#839496;">    name: </span><span style="color:#2AA198;">&#39;app1&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">    entry: </span><span style="color:#2AA198;">&#39;//localhost:7100&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">    container: </span><span style="color:#2AA198;">&#39;#container&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">    activeRule: </span><span style="color:#2AA198;">&#39;/app1&#39;</span></span>
<span class="line"><span style="color:#839496;">  },</span></span>
<span class="line"><span style="color:#839496;">  {</span></span>
<span class="line"><span style="color:#839496;">    name: </span><span style="color:#2AA198;">&#39;app2&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">    entry: </span><span style="color:#2AA198;">&#39;//localhost:7200&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">    container: </span><span style="color:#2AA198;">&#39;#container&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">    activeRule: </span><span style="color:#2AA198;">&#39;/app2&#39;</span></span>
<span class="line"><span style="color:#839496;">  }</span></span>
<span class="line"><span style="color:#839496;">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#268BD2;">start</span><span style="color:#839496;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586E75;font-style:italic;">// 子应用</span></span>
<span class="line"><span style="color:#859900;">export</span><span style="color:#93A1A1;font-weight:bold;"> async</span><span style="color:#93A1A1;font-weight:bold;"> function</span><span style="color:#268BD2;"> mount</span><span style="color:#839496;">(props) {</span></span>
<span class="line"><span style="color:#268BD2;">  ReactDOM</span><span style="color:#839496;">.</span><span style="color:#268BD2;">render</span><span style="color:#839496;">(</span></span>
<span class="line"><span style="color:#586E75;">    &lt;</span><span style="color:#859900;">App</span><span style="color:#586E75;"> /&gt;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#268BD2;">    props</span><span style="color:#839496;">.</span><span style="color:#268BD2;">container</span><span style="color:#859900;"> ?</span><span style="color:#268BD2;"> props</span><span style="color:#839496;">.</span><span style="color:#268BD2;">container</span><span style="color:#839496;">.</span><span style="color:#268BD2;">querySelector</span><span style="color:#839496;">(</span><span style="color:#2AA198;">&#39;#root&#39;</span><span style="color:#839496;">) </span><span style="color:#859900;">:</span><span style="color:#268BD2;"> document</span><span style="color:#839496;">.</span><span style="color:#268BD2;">getElementById</span><span style="color:#839496;">(</span><span style="color:#2AA198;">&#39;root&#39;</span><span style="color:#839496;">)</span></span>
<span class="line"><span style="color:#839496;">  );</span></span>
<span class="line"><span style="color:#839496;">}</span></span></code></pre></div><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki solarized-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#586E75;font-style:italic;">// 模块联邦</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">// 模块提供方</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">// webpack.config.js</span></span>
<span class="line"><span style="color:#859900;">module</span><span style="color:#839496;">.</span><span style="color:#859900;">exports</span><span style="color:#859900;"> =</span><span style="color:#839496;"> {</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  // ...</span></span>
<span class="line"><span style="color:#839496;">  plugins: [</span></span>
<span class="line"><span style="color:#859900;">    new</span><span style="color:#268BD2;"> ModuleFederationPlugin</span><span style="color:#839496;">({</span></span>
<span class="line"><span style="color:#839496;">      name: </span><span style="color:#2AA198;">&#39;app1&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">      filename: </span><span style="color:#2AA198;">&#39;remoteEntry.js&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">      exposes: {</span></span>
<span class="line"><span style="color:#2AA198;">        &#39;./Button&#39;</span><span style="color:#839496;">: </span><span style="color:#2AA198;">&#39;./src/Button&#39;</span></span>
<span class="line"><span style="color:#839496;">      }</span></span>
<span class="line"><span style="color:#839496;">    })</span></span>
<span class="line"><span style="color:#839496;">  ]</span></span>
<span class="line"><span style="color:#839496;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586E75;font-style:italic;">// 模块消费方</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">// webpack.config.js</span></span>
<span class="line"><span style="color:#859900;">module</span><span style="color:#839496;">.</span><span style="color:#859900;">exports</span><span style="color:#859900;"> =</span><span style="color:#839496;"> {</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  // ...</span></span>
<span class="line"><span style="color:#839496;">  plugins: [</span></span>
<span class="line"><span style="color:#859900;">    new</span><span style="color:#268BD2;"> ModuleFederationPlugin</span><span style="color:#839496;">({</span></span>
<span class="line"><span style="color:#839496;">      name: </span><span style="color:#2AA198;">&#39;app2&#39;</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">      remotes: {</span></span>
<span class="line"><span style="color:#839496;">        app1: </span><span style="color:#2AA198;">&#39;app1@http://localhost:3001/remoteEntry.js&#39;</span></span>
<span class="line"><span style="color:#839496;">      }</span></span>
<span class="line"><span style="color:#839496;">    })</span></span>
<span class="line"><span style="color:#839496;">  ]</span></span>
<span class="line"><span style="color:#839496;">};</span></span></code></pre></div></div></div><p>以 qiankun 为代表的方案</p><div class="tip custom-block github-alert"><p class="custom-block-title">TIP</p><p></p><ul><li>监听路由自动的加载、卸载当前路由对应的子应用</li><li>完备的沙箱方案，js 沙箱做了 SnapshotSandbox、LegacySandbox、ProxySandbox 三套渐进增强方案，css 沙箱做了两套 strictStyleIsolation、experimentalStyleIsolation 两套适用不同场景的方案</li><li>路由保持，浏览器刷新、前进、后退，都可以作用到子应用</li><li>应用间通信简单，全局注入</li></ul></div><div class="caution custom-block github-alert"><p class="custom-block-title">CAUTION</p><p></p><ul><li>基于路由匹配，无法同时激活多个子应用，也不支持子应用保活</li><li>改造成本较大，从 webpack、代码、路由等等都要做一系列的适配</li><li>css 沙箱无法绝对的隔离，js 沙箱在某些场景下执行性能下降严重</li><li>无法支持 vite 等 ESM 脚本运行</li></ul></div><p>以 wujie 为代表的方案</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><ol><li>多应用同时激活在线。</li></ol><ul><li>框架具备同时激活多应用，并保持这些应用路由同步的能力</li></ul><ol start="2"><li>组件式的使用方式。</li></ol><ul><li>无需注册，更无需路由适配，在组件内使用，跟随组件装载、卸载</li></ul><ol start="3"><li>应用级别的 keep-alive。</li></ol><ul><li>子应用开启保活模式后，应用发生切换时整个子应用的状态可以保存下来不丢失，结合预执行模式可以获得类似 ssr 的打开体验</li></ul><ol start="4"><li>纯净无污染。</li></ol><ul><li>无界利用 iframe 和 webcomponent 来搭建天然的 js 隔离沙箱和 css 隔离沙箱</li><li>利用 iframe 的 history 和主应用的 history 在同一个 top-level browsing context 来搭建天然的路由同步机制</li><li>副作用局限在沙箱内部，子应用切换无需任何清理工作，没有额外的切换成本</li></ul><ol start="5"><li>性能和体积兼具。</li></ol><ul><li>子应用执行性能和原生一致，子应用实例 instance 运行在 iframe 的 window 上下文中，避免 with(proxyWindow){code}这样指定代码执行上下文导致的性能下降，但是多了实例化 iframe 的一次性的开销，可以通过 preload 提前实例化</li><li>体积比较轻量，借助 iframe 和 webcomponent 来实现沙箱，有效的减小了代码量</li></ul><ol start="6"><li>开箱即用。</li></ol><ul><li>不管是样式的兼容、路由的处理、弹窗的处理、热更新的加载，子应用完成接入即可开箱即用无需额外处理，应用接入成本也极低</li></ul></div><h3 id="_4-模块联邦" tabindex="-1">4. 模块联邦 <a class="header-anchor" href="#_4-模块联邦" aria-label="Permalink to &quot;4. 模块联邦&quot;">​</a></h3><p>模块联邦使多个独立的构建可以形成一个应用程序。这些独立的构建不会相互依赖，因此可以单独开发和部署它们。去中心化的思路，每个应用都可以是提供者和使用者，不同应用间可以实现共同依赖的复用，避免重复加载。</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><ul><li>使用成本高，配置项繁琐</li><li>仅提供了共享模块的能力，其余的问题如 js 沙箱、css 沙箱、跨应用状态共享、共享模块 ts 声明都需要自行解决</li></ul></div><p>百度 emp 是基于模块联邦的微前端解决方案，在共享模块能力之上提供了更多的特性支持，如远程拉取 ts 声明文件、跨应用状态共享、跨框架组件调用。但其核心依然是面向模块共享，需要自行实现 js、css 沙箱</p><h2 id="个推中台业务微前端落地" tabindex="-1">个推中台业务微前端落地 <a class="header-anchor" href="#个推中台业务微前端落地" aria-label="Permalink to &quot;个推中台业务微前端落地&quot;">​</a></h2><h3 id="业务背景介绍" tabindex="-1">业务背景介绍 <a class="header-anchor" href="#业务背景介绍" aria-label="Permalink to &quot;业务背景介绍&quot;">​</a></h3><p>中台业务部门提供通用的大数据能力，在给业务部门赋能的同时，自身也沉淀了一套大数据操作系统</p><p><img src="/Jarrett-blog/assets/middle-ground.CwdbmR9i.png" alt="数据智能操作系统" loading="lazy"><img src="/Jarrett-blog/assets/solution.BnrGAHmA.png" alt="业务赋能" loading="lazy"><img src="/Jarrett-blog/assets/intro.DXDGuh2f.png" alt="介绍" loading="lazy"></p><h3 id="微前端为团队带来了什么价值" tabindex="-1">微前端为团队带来了什么价值 <a class="header-anchor" href="#微前端为团队带来了什么价值" aria-label="Permalink to &quot;微前端为团队带来了什么价值&quot;">​</a></h3><ol><li>既独立又统一</li></ol><ul><li>主应用统一引入皮肤包。子应用统一使用 css 变量，仅修改主应用即可完成所有应用的皮肤新增、切换</li><li>主应用统一做数据埋点。子应用无需做任何改动</li><li>统一的全局业务、配置管理</li></ul><p>基座。作为微前端的入口，负责登录校验、权限配置、部门管理、用户管理等所有公共的模块，并向子应用下发诸如皮肤变量、用户信息、公用状态等数据</p><p><img src="/Jarrett-blog/assets/index.CPYeQPkI.png" alt="首页" loading="lazy"></p><ol start="2"><li>灵活的业务场景构想</li></ol><ul><li>自由组合子应用页面。细分到子应用菜单级别，用户可自定义创建拖拽创建页面组合即“自定义应用”，实现场景化、定制化的业务流</li><li>自由嵌套子应用组件。每个应用自身作为子应用接入的同时，还可提供自身的组件，极大减少业务开发量</li><li>定制化部署。对于不同客户的定制化部署需求，无需多次打包，一份配置项即可完成子应用的接入与否</li><li>对现有业务的整合。高效、快速的将现有业务集成，聚合成如工作流</li></ul><p>建模平台。子应用接入运行</p><p><img src="/Jarrett-blog/assets/modeling.DHXS369S.png" alt="建模平台" loading="lazy"></p><p>机器学习平台。子应用嵌套 <img src="/Jarrett-blog/assets/word-cloud.BI-KLn1s.png" alt="机器学习平台" loading="lazy"></p><p>应用市场。子应用页面自由组合 <img src="/Jarrett-blog/assets/app-market.BlBRT8m1.png" alt="应用市场" loading="lazy"></p><ol start="3"><li>独立开发、部署带来的便利</li></ol><ul><li>独立仓库、独立团队，并行开发、独立打包提测，能够更加快速且针对性地响应客户需求。</li><li>兼容不同技术栈。对于远古项目使用的老旧技术栈能够快速接入，已接入项目技术栈重构也可以按项目逐个迭代，甚至可以进一步按模块拆分，颗粒度更细</li><li>降低单个项目复杂度，减少维护成本</li><li>安全。沙箱的存在使得不同技术栈项目的渐进式融合更加方便，且风险降低</li></ul><h3 id="微前端带来了什么问题" tabindex="-1">微前端带来了什么问题 <a class="header-anchor" href="#微前端带来了什么问题" aria-label="Permalink to &quot;微前端带来了什么问题&quot;">​</a></h3><ol><li>多应用运行与单应用运行行为不一致的问题。single-spa 重写了某些原生方法，比如 history.push，使其必然触发 popstate 事件，会导致路由守卫等路由相关行为不符合正常的预期</li><li>微前端提供了沙箱，但各应用间并非完完全全的隔离。如 localStorage、sessionStorage、history 等都是共用的，需要针对各个共用部分，拉齐团队规范，避免出现如 A 团队往 localStorage 中存了变量被 B 团队覆盖的问题</li><li>各团队独立打包，存在多余的代码引入，且版本可能不一。A、B 团队都使用了 vue 技术栈，各自本地打包</li><li>共有问题的修改成本高。子应用统一使用了某组件库，但该组件库仅为单体应用设计，并未考虑多应用实例，导致多应用场景下出现问题，如果子应用是自行打包，需要在组件库修改完后，子应用逐个更新依赖并部署。同时，由于项目的负责团队不同，往往涉及到非常长的沟通流程</li></ol><h2 id="我们真的需要微前端吗" tabindex="-1">我们真的需要微前端吗 <a class="header-anchor" href="#我们真的需要微前端吗" aria-label="Permalink to &quot;我们真的需要微前端吗&quot;">​</a></h2><p>如果你不知道自己是否需要用微前端，那么大概率是不需要</p><ul><li><a href="https://juejin.cn/post/7236021829000691771#heading-10" target="_blank" rel="noreferrer">2023 微前端技术方案选型</a></li><li><a href="https://lianpf.github.io/posts/frontend-develop/microfrontend_framework_compare#1%e5%ae%9e%e7%8e%b0%e6%96%b9%e6%a1%88-2" target="_blank" rel="noreferrer">微前端方案解析</a></li></ul><h2 id="qiankun-是怎么做-js-隔离的" tabindex="-1">qiankun 是怎么做 js 隔离的 <a class="header-anchor" href="#qiankun-是怎么做-js-隔离的" aria-label="Permalink to &quot;qiankun 是怎么做 js 隔离的&quot;">​</a></h2><p>sandbox，参数默认为 true，对于 js 隔离，默认使用 proxy 沙箱，有个文档上没写的隐藏参数 loose，区分使用 legacySandbox 和 proxySandbox</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki solarized-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#93A1A1;font-weight:bold;">type</span><span style="color:#CB4B16;"> QiankunSpecialOpts</span><span style="color:#859900;"> =</span><span style="color:#839496;"> {</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">   * </span><span style="color:#93A1A1;font-weight:bold;">@deprecated</span><span style="color:#586E75;font-style:italic;"> internal api, don&#39;t used it as normal, might be removed after next version</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#839496;">  $$cacheLifecycleByAppName</span><span style="color:#859900;">?:</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#839496;">  prefetch</span><span style="color:#859900;">?:</span><span style="color:#CB4B16;"> PrefetchStrategy</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#839496;">  sandbox</span><span style="color:#859900;">?:</span></span>
<span class="line"><span style="color:#859900;">    |</span><span style="color:#859900;"> boolean</span></span>
<span class="line"><span style="color:#859900;">    |</span><span style="color:#839496;"> {</span></span>
<span class="line"><span style="color:#839496;">        strictStyleIsolation</span><span style="color:#859900;">?:</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#839496;">        experimentalStyleIsolation</span><span style="color:#859900;">?:</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">        /**</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">         * </span><span style="color:#93A1A1;font-weight:bold;">@deprecated</span><span style="color:#586E75;font-style:italic;"> We use strict mode by default</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">         */</span></span>
<span class="line"><span style="color:#839496;">        loose</span><span style="color:#859900;">?:</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">        /**</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">         * use speed sandbox mode, enabled by default from 2.9.0</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">         */</span></span>
<span class="line"><span style="color:#839496;">        speedy</span><span style="color:#859900;">?:</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#839496;">        patchers</span><span style="color:#859900;">?:</span><span style="color:#CB4B16;"> Patcher</span><span style="color:#839496;">[];</span></span>
<span class="line"><span style="color:#839496;">      };</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  /*</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">    with singular mode, any app will wait to load until other apps are unmouting</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">    it is useful for the scenario that only one sub app shown at one time</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  */</span></span>
<span class="line"><span style="color:#839496;">  singular</span><span style="color:#859900;">?:</span><span style="color:#859900;"> boolean</span><span style="color:#859900;"> |</span><span style="color:#839496;"> ((app</span><span style="color:#859900;">:</span><span style="color:#CB4B16;"> LoadableApp</span><span style="color:#839496;">&lt;</span><span style="color:#859900;">any</span><span style="color:#839496;">&gt;) </span><span style="color:#93A1A1;font-weight:bold;">=&gt;</span><span style="color:#CB4B16;"> Promise</span><span style="color:#839496;">&lt;</span><span style="color:#859900;">boolean</span><span style="color:#839496;">&gt;);</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">   * skip some scripts or links intercept, like JSONP</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#268BD2;">  excludeAssetFilter</span><span style="color:#859900;">?:</span><span style="color:#839496;"> (url</span><span style="color:#859900;">:</span><span style="color:#859900;"> string</span><span style="color:#839496;">) </span><span style="color:#93A1A1;font-weight:bold;">=&gt;</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#839496;">  globalContext</span><span style="color:#859900;">?:</span><span style="color:#859900;"> typeof</span><span style="color:#268BD2;"> window</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#839496;">};</span></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki solarized-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#93A1A1;font-weight:bold;">const</span><span style="color:#268BD2;"> useLooseSandbox</span><span style="color:#859900;"> =</span><span style="color:#859900;"> typeof</span><span style="color:#268BD2;"> sandbox</span><span style="color:#859900;"> ===</span><span style="color:#2AA198;"> &#39;object&#39;</span><span style="color:#859900;"> &amp;&amp;</span><span style="color:#859900;"> !!</span><span style="color:#268BD2;">sandbox</span><span style="color:#839496;">.</span><span style="color:#268BD2;">loose</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">// enable speedy mode by default</span></span>
<span class="line"><span style="color:#93A1A1;font-weight:bold;">const</span><span style="color:#268BD2;"> speedySandbox</span><span style="color:#859900;"> =</span><span style="color:#859900;"> typeof</span><span style="color:#268BD2;"> sandbox</span><span style="color:#859900;"> ===</span><span style="color:#2AA198;"> &#39;object&#39;</span><span style="color:#859900;"> ?</span><span style="color:#268BD2;"> sandbox</span><span style="color:#839496;">.</span><span style="color:#268BD2;">speedy</span><span style="color:#859900;"> !==</span><span style="color:#B58900;"> false</span><span style="color:#859900;"> :</span><span style="color:#B58900;"> true</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#93A1A1;font-weight:bold;">let</span><span style="color:#268BD2;"> sandboxContainer</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#859900;">if</span><span style="color:#839496;"> (</span><span style="color:#268BD2;">sandbox</span><span style="color:#839496;">) {</span></span>
<span class="line"><span style="color:#268BD2;">  sandboxContainer</span><span style="color:#859900;"> =</span><span style="color:#268BD2;"> createSandboxContainer</span><span style="color:#839496;">(</span></span>
<span class="line"><span style="color:#268BD2;">    appInstanceId</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">    // FIXME should use a strict sandbox logic while remount, see https://github.com/umijs/qiankun/issues/518</span></span>
<span class="line"><span style="color:#268BD2;">    initialAppWrapperGetter</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#268BD2;">    scopedCSS</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#268BD2;">    useLooseSandbox</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#268BD2;">    excludeAssetFilter</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#268BD2;">    global</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#268BD2;">    speedySandbox</span></span>
<span class="line"><span style="color:#839496;">  );</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  // 用沙箱的代理对象作为接下来使用的全局对象</span></span>
<span class="line"><span style="color:#268BD2;">  global</span><span style="color:#859900;"> =</span><span style="color:#268BD2;"> sandboxContainer</span><span style="color:#839496;">.</span><span style="color:#268BD2;">instance</span><span style="color:#839496;">.</span><span style="color:#268BD2;">proxy</span><span style="color:#859900;"> as</span><span style="color:#859900;"> typeof</span><span style="color:#268BD2;"> window</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#268BD2;">  mountSandbox</span><span style="color:#859900;"> =</span><span style="color:#268BD2;"> sandboxContainer</span><span style="color:#839496;">.</span><span style="color:#268BD2;">mount</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#268BD2;">  unmountSandbox</span><span style="color:#859900;"> =</span><span style="color:#268BD2;"> sandboxContainer</span><span style="color:#839496;">.</span><span style="color:#268BD2;">unmount</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#839496;">}</span></span></code></pre></div><p>qinakun 在创建沙箱时有以下代码</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki solarized-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#93A1A1;font-weight:bold;">function</span><span style="color:#268BD2;"> createSandboxContainer</span><span style="color:#839496;">(</span></span>
<span class="line"><span style="color:#839496;">  appName</span><span style="color:#859900;">:</span><span style="color:#859900;"> string</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#268BD2;">  elementGetter</span><span style="color:#859900;">:</span><span style="color:#839496;"> () </span><span style="color:#93A1A1;font-weight:bold;">=&gt;</span><span style="color:#CB4B16;"> HTMLElement</span><span style="color:#859900;"> |</span><span style="color:#CB4B16;"> ShadowRoot</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">  scopedCSS</span><span style="color:#859900;">:</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">  useLooseSandbox</span><span style="color:#859900;">?:</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#268BD2;">  excludeAssetFilter</span><span style="color:#859900;">?:</span><span style="color:#839496;"> (url</span><span style="color:#859900;">:</span><span style="color:#859900;"> string</span><span style="color:#839496;">) </span><span style="color:#93A1A1;font-weight:bold;">=&gt;</span><span style="color:#859900;"> boolean</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">  globalContext</span><span style="color:#859900;">?:</span><span style="color:#859900;"> typeof</span><span style="color:#268BD2;"> window</span><span style="color:#839496;">,</span></span>
<span class="line"><span style="color:#839496;">  speedySandBox</span><span style="color:#859900;">?:</span><span style="color:#859900;"> boolean</span></span>
<span class="line"><span style="color:#839496;">) {</span></span>
<span class="line"><span style="color:#93A1A1;font-weight:bold;">  let</span><span style="color:#268BD2;"> sandbox</span><span style="color:#859900;">:</span><span style="color:#CB4B16;"> SandBox</span><span style="color:#839496;">;</span></span>
<span class="line"><span style="color:#859900;">  if</span><span style="color:#839496;"> (</span><span style="color:#268BD2;">window</span><span style="color:#839496;">.</span><span style="color:#268BD2;">Proxy</span><span style="color:#839496;">) {</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">    // 如果浏览器支持Proxy，使用LegacySandBox或者ProxySandbox</span></span>
<span class="line"><span style="color:#268BD2;">    sandbox</span><span style="color:#859900;"> =</span><span style="color:#268BD2;"> useLooseSandbox</span></span>
<span class="line"><span style="color:#859900;">      ?</span><span style="color:#859900;"> new</span><span style="color:#268BD2;"> LegacySandbox</span><span style="color:#839496;">(</span><span style="color:#268BD2;">appName</span><span style="color:#839496;">, </span><span style="color:#268BD2;">globalContext</span><span style="color:#839496;">)</span></span>
<span class="line"><span style="color:#859900;">      :</span><span style="color:#859900;"> new</span><span style="color:#268BD2;"> ProxySandbox</span><span style="color:#839496;">(</span><span style="color:#268BD2;">appName</span><span style="color:#839496;">, </span><span style="color:#268BD2;">globalContext</span><span style="color:#839496;">, { speedy: </span><span style="color:#859900;">!!</span><span style="color:#268BD2;">speedySandBox</span><span style="color:#839496;"> });</span></span>
<span class="line"><span style="color:#839496;">  } </span><span style="color:#859900;">else</span><span style="color:#839496;"> {</span></span>
<span class="line"><span style="color:#586E75;font-style:italic;">    // 否则使用SnapshotSandBox</span></span>
<span class="line"><span style="color:#268BD2;">    sandbox</span><span style="color:#859900;"> =</span><span style="color:#859900;"> new</span><span style="color:#268BD2;"> SnapshotSandbox</span><span style="color:#839496;">(</span><span style="color:#268BD2;">appName</span><span style="color:#839496;">);</span></span>
<span class="line"><span style="color:#839496;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#586E75;font-style:italic;">  // ...</span></span>
<span class="line"><span style="color:#839496;">}</span></span></code></pre></div><h3 id="快照沙箱" tabindex="-1">快照沙箱 <a class="header-anchor" href="#快照沙箱" aria-label="Permalink to &quot;快照沙箱&quot;">​</a></h3><p>基于 diff 实现，只适用单例，且会污染 window</p><p>原理：将 window 的快照信息存到 windowSnapshot 中，将应用对于 window 属性的丢该记录到 modifyPropsMap 中，加载应用时用来还原，卸载应用时还原 window</p><h3 id="代理沙箱" tabindex="-1">代理沙箱 <a class="header-anchor" href="#代理沙箱" aria-label="Permalink to &quot;代理沙箱&quot;">​</a></h3><h4 id="legacysandbox" tabindex="-1">legacySandbox <a class="header-anchor" href="#legacysandbox" aria-label="Permalink to &quot;legacySandbox&quot;">​</a></h4><p>单例，跟快照沙箱差不多，也会污染 window，但是性能比快照好</p><h4 id="proxysandbox" tabindex="-1">ProxySandbox <a class="header-anchor" href="#proxysandbox" aria-label="Permalink to &quot;ProxySandbox&quot;">​</a></h4><p>创建了 fakeWindow，set 操作都在 fakeWindow 上，取值优先从 fakeWindow 上取，不会污染 window，且支持多例</p><p>需要注意对于 window 的拷贝是浅拷贝，一些对象属性如 history，主子应用是共用的</p><h2 id="qiankun-是怎么做-css-隔离的" tabindex="-1">qiankun 是怎么做 css 隔离的 <a class="header-anchor" href="#qiankun-是怎么做-css-隔离的" aria-label="Permalink to &quot;qiankun 是怎么做 css 隔离的&quot;">​</a></h2><p>sandbox 参数，有两个是关于 css 的，strictStyleIsolation 默认 false、experimentalStyleIsolation 默认 false</p><p>strictStyleIsolation 为 true 时，用 shadowDom 隔离，shadowDom 的特点是：</p><ul><li>影子节点内的导入样式不会影响外层</li><li>mode 为 closed 时，外层无法获取影子节点内的元素</li><li>影子节点内的元素样式会继承其宿主元素的样式</li><li>影子节点内的元素无法被外层选择器选中</li></ul><p>experimentalStyleIsolation 为 true 时，类似 vue 的 scoped 实现，通过属性选择器隔离</p></div></div></main><footer class="VPDocFooter" data-v-3f19d6b0 data-v-9ba61ddb><!--[--><!--]--><div class="edit-info" data-v-9ba61ddb><div class="edit-link" data-v-9ba61ddb><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/Jarrett817/Jarrett-blog/edit/main/docs/front-end/micro-front/index.md" target="_blank" rel="noreferrer" data-v-9ba61ddb><!--[--><span class="vpi-square-pen edit-link-icon" data-v-9ba61ddb></span> Edit this page on GitHub<!--]--></a></div><div class="last-updated" data-v-9ba61ddb><p class="VPLastUpdated" data-v-9ba61ddb data-v-dce6c4e2>Last Updated: <time datetime="2025-01-18T05:48:33.000Z" data-v-dce6c4e2></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-9ba61ddb><span class="visually-hidden" id="doc-footer-aria-label" data-v-9ba61ddb>Pager</span><div class="pager" data-v-9ba61ddb><a class="VPLink link pager-link prev" href="/Jarrett-blog/front-end/canvas/" data-v-9ba61ddb><!--[--><span class="desc" data-v-9ba61ddb>Previous page</span><span class="title" data-v-9ba61ddb>canvas</span><!--]--></a></div><div class="pager" data-v-9ba61ddb><a class="VPLink link pager-link next" href="/Jarrett-blog/front-end/miniprogram/" data-v-9ba61ddb><!--[--><span class="desc" data-v-9ba61ddb>Next page</span><span class="title" data-v-9ba61ddb>小程序</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-ffb09705 data-v-3496d641><div class="container" data-v-3496d641><p class="message" data-v-3496d641>Released under the MIT License.</p><p class="copyright" data-v-3496d641>MIT Licensed | Copyright © 2021-present Jarrett Wang</p></div></footer><!--[--><div class="n-back-top-placeholder" style="display: none" aria-hidden="true" data-v-e044f95b><!----></div><!--]--></div></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"computer-basic_arithmetic_index.md\":\"CzT_rlIp\",\"computer-basic_design-pattern_index.md\":\"rGAEb7kM\",\"computer-basic_internet_index.md\":\"DPUxJmKp\",\"front-end_browser_index.md\":\"Cs27taAQ\",\"front-end_canvas_index.md\":\"CHFjyw0_\",\"front-end_css_index.md\":\"Bcp7l5W1\",\"front-end_git_index.md\":\"CKJu7ueo\",\"front-end_html_index.md\":\"D8ZslFa7\",\"front-end_js_faq.md\":\"D6-DVbE8\",\"front-end_js_index.md\":\"CEXmCnp2\",\"front-end_micro-front_index.md\":\"CvufYgRx\",\"front-end_miniprogram_index.md\":\"D8UiokhN\",\"front-end_nodejs_index.md\":\"C0JariJ-\",\"front-end_ts_faq.md\":\"CcOrCXrk\",\"front-end_ts_index.md\":\"BBKFg3hc\",\"front-end_vue3_diff.md\":\"CCFSPgFi\",\"front-end_vue3_index.md\":\"D9ykJFfH\",\"front-end_vue_index.md\":\"C8etICUo\",\"index.md\":\"bnZHaE_A\",\"knowledge-map.md\":\"BDaTGmYZ\",\"plan_api-test_index.md\":\"CWo9gAea\",\"plan_front-end-infrastructure_index.md\":\"BsPm8t4N\",\"plan_how-to-make-ts-useful_index.md\":\"Dn2DcqHP\",\"plan_micro-fe-communication_index.md\":\"CNpvxoc4\",\"plan_navigation_index.md\":\"w0EYq4v_\",\"practice_leetcode.md\":\"WkMp1Edn\",\"practice_promise.md\":\"BzvcvJpP\",\"resume_index.md\":\"Ds_WKrNd\",\"tools_slides.md\":\"Bzbfs_Cf\",\"web3_index.md\":\"DrWiqKoY\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"🏠 JarrettBlog\",\"titleTemplate\":\"Vite & Vue powered static site generator\",\"description\":\"前端学习笔记\",\"base\":\"/Jarrett-blog/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/Jarrett817/Jarrett-blog\"},{\"icon\":{\"svg\":\"<svg t=\\\"1658975064450\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"14624\\\" width=\\\"500\\\" height=\\\"500\\\"><path d=\\\"M465.189 161.792c-22.967 18.14-44.325 35.109-47.397 37.742l-5.851 4.68 10.971 8.632c5.998 4.827 11.85 9.508 13.02 10.532 1.17 1.024 17.993 14.336 37.156 29.696l34.962 27.795 5.267-3.95c2.925-2.194 23.259-18.432 45.348-35.986 21.943-17.555 41.253-32.768 42.716-33.646 1.609-1.024 2.779-2.194 2.779-2.78 0-0.438-9.655-8.63-21.504-17.846-11.995-9.363-22.674-17.847-23.845-18.871-15.945-13.02-49.737-39.059-50.76-39.059-0.586 0.147-19.896 14.922-42.862 33.061z m233.325 180.37C507.465 493.275 508.928 492.105 505.417 489.911c-3.072-1.902-11.556-8.485-64.073-50.03-9.07-7.168-18.578-14.775-21.358-16.823-2.78-2.194-8.777-6.875-13.312-10.532-4.68-3.657-10.679-8.339-13.312-10.533-13.165-10.24-71.095-56.027-102.107-80.457-5.852-4.681-11.41-8.485-12.142-8.485-0.731 0-10.971 7.754-22.674 17.116-11.703 9.508-22.674 18.286-24.284 19.456-1.755 1.17-5.12 3.95-7.46 6.144-2.34 2.34-4.828 4.096-5.413 4.096-3.072 0-0.731 3.072 6.437 8.777 4.096 3.218 8.777 6.875 10.094 8.046 1.316 1.024 10.24 8.045 19.748 15.506s23.26 18.286 30.428 23.99c19.31 15.215 31.89 25.308 127.853 101.084 47.836 37.742 88.796 69.779 90.844 71.095 3.657 2.487 3.95 2.487 7.46-0.292a1041.42 1041.42 0 0 0 16.092-12.727c6.875-5.413 14.775-11.703 17.554-13.897 30.135-23.699 80.018-63.05 81.774-64.512 1.17-1.024 12.434-9.802 24.868-19.603s37.888-29.696 56.32-44.324c18.579-14.629 46.227-36.425 61.733-48.567 15.506-12.142 27.794-22.528 27.502-23.26-0.878-1.17-57.637-47.104-59.978-48.274-0.731-0.439-18.578 12.727-39.497 29.257z\\\" fill=\\\"#006CFF\\\" p-id=\\\"14625\\\"></path><path d=\\\"M57.93 489.326c-15.215 12.288-28.527 23.405-29.697 24.576-2.34 2.194-5.412-0.44 80.018 66.852 33.207 26.185 32.622 25.747 57.637 45.495 10.386 8.192 36.279 28.672 57.783 45.495 38.18 30.135 44.91 35.401 52.663 41.545 2.048 1.756 22.967 18.14 46.372 36.572 23.26 18.432 74.167 58.514 112.933 89.088 38.912 30.573 71.095 55.734 71.826 56.027 0.732 0.293 7.46-4.389 14.921-10.386 21.797-16.97 90.259-70.949 101.523-79.872 5.705-4.535 12.873-10.24 15.945-12.58 3.072-2.488 6.436-5.12 7.314-5.852 0.878-0.878 11.85-9.509 24.283-19.31 20.773-16.091 59.1-46.226 64.366-50.615 1.17-1.024 5.12-4.096 8.777-6.875 3.657-2.78 7.9-6.29 9.509-7.607 1.609-1.317 14.775-11.703 29.257-23.113 29.11-22.82 42.277-33.207 88.503-69.632 17.262-13.605 32.475-25.454 33.646-26.478 2.486-2.048 31.451-24.869 44.617-35.255 4.827-3.657 9.07-7.168 9.508-7.607 0.44-0.585 5.998-4.827 12.435-9.8 6.436-4.828 13.165-10.24 15.067-11.85l3.365-2.926-9.948-7.753c-5.412-4.388-10.24-8.192-10.679-8.63-1.17-1.317-22.381-18.433-30.135-24.284-3.95-3.072-7.314-5.998-7.606-6.73-1.317-3.071-6.73 0.147-29.258 17.994-13.458 10.532-25.746 20.187-27.355 21.504-1.61 1.463-10.533 8.338-19.749 15.652-9.216 7.168-17.115 13.459-17.554 13.898-0.439 0.438-6.583 5.412-13.897 10.971-7.168 5.559-15.214 11.703-17.7 13.75-4.974 4.097-5.413 4.39-20.334 16.239-5.56 4.388-11.264 8.777-12.435 9.8-1.17 1.025-20.333 16.092-42.422 33.354-22.09 17.408-41.546 32.768-43.155 34.084-1.609 1.463-14.482 11.557-28.525 22.528s-40.814 32.037-59.539 46.812c-18.578 14.775-42.276 33.353-52.516 41.399s-23.26 18.285-28.965 22.82l-10.386 8.339-4.389-3.072c-2.34-1.756-4.68-3.511-5.12-3.95-0.439-0.439-4.973-4.096-10.24-8.046-11.849-9.216-14.482-11.264-16.676-13.166-0.878-0.877-4.243-3.51-7.46-5.851-3.22-2.487-6.145-4.681-6.584-5.12-0.439-0.439-6.875-5.705-14.482-11.703-7.607-5.851-14.921-11.556-16.091-12.58-1.317-1.17-17.116-13.605-35.255-27.795-17.993-14.19-35.109-27.648-38.035-29.842-5.705-4.681-33.499-26.624-125.074-98.743-34.523-27.209-72.704-57.344-84.846-66.852-49.737-39.498-55.15-43.594-56.905-43.447-0.877 0-14.043 10.24-29.257 22.528z\\\" fill=\\\"#006CFF\\\" p-id=\\\"14626\\\"></path></svg>\"},\"link\":\"https://juejin.cn/user/3940246036687774\"}],\"editLink\":{\"pattern\":\"https://github.com/Jarrett817/Jarrett-blog/edit/main/docs/:path\",\"text\":\"Edit this page on GitHub\"},\"lastUpdatedText\":\"Last Updated\",\"nav\":[{\"text\":\"📘 前端基础\",\"link\":\"/front-end/html/\",\"activeMatch\":\"^/front-end/\"},{\"text\":\"📚 计算机基础\",\"link\":\"/computer-basic/design-pattern/\",\"activeMatch\":\"^/computer-basic/\"},{\"text\":\"🏹 方案\",\"link\":\"/plan/micro-fe-communication/\",\"activeMatch\":\"^/plan/\"},{\"text\":\"✍ 练习题\",\"link\":\"/practice/leetcode\",\"activeMatch\":\"^/pratice/\"},{\"text\":\"📘 WEB3\",\"link\":\"/web3/\",\"activeMatch\":\"^/web3/\"},{\"text\":\"🔖 简历\",\"link\":\"/resume/index.html\",\"activeMatch\":\"^/resume/\"}],\"sidebar\":[{\"text\":\"前端基础\",\"items\":[{\"text\":\"HTML\",\"link\":\"/front-end/html/\"},{\"text\":\"CSS\",\"link\":\"/front-end/css/\"},{\"text\":\"JS\",\"link\":\"/front-end/js/\"},{\"text\":\"TS\",\"link\":\"/front-end/ts/\"},{\"text\":\"浏览器\",\"link\":\"/front-end/browser/\"},{\"text\":\"vue\",\"link\":\"/front-end/vue/\"},{\"text\":\"vue3\",\"link\":\"/front-end/vue3/\"},{\"text\":\"nodejs\",\"link\":\"/front-end/nodejs/\"},{\"text\":\"git\",\"link\":\"/front-end/git/\"},{\"text\":\"canvas\",\"link\":\"/front-end/canvas/\"},{\"text\":\"微前端\",\"link\":\"/front-end/micro-front/\"},{\"text\":\"小程序\",\"link\":\"/front-end/miniprogram/\"}]},{\"text\":\"计算机基础\",\"items\":[{\"text\":\"设计模式\",\"link\":\"/computer-basic/design-pattern/\"},{\"text\":\"计算机网络\",\"link\":\"/computer-basic/internet/\"},{\"text\":\"数据结构与算法\",\"link\":\"/computer-basic/arithmetic/\"}]},{\"text\":\"方案\",\"items\":[{\"text\":\"多级跳转\",\"link\":\"/plan/navigation/\"},{\"text\":\"微前端下的主子通信\",\"link\":\"/plan/micro-fe-communication/\"},{\"text\":\"接口测试平台\",\"link\":\"/plan/api-test/\"},{\"text\":\"10分钟速通TS\",\"link\":\"/plan/how-to-make-ts-useful/\"},{\"text\":\"前端基建（一）\",\"link\":\"/plan/front-end-infrastructure/\"}]},{\"text\":\"WEB3\",\"items\":[{\"text\":\"新手入门\",\"link\":\"/web3/index\"}]},{\"text\":\"练习题\",\"items\":[{\"text\":\"算法题\",\"link\":\"/practice/leetcode\"},{\"text\":\"Promise\",\"link\":\"/practice/promise\"}]}],\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"MIT Licensed | Copyright © 2021-present Jarrett Wang\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>